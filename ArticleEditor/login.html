<!DOCTYPE html>
<html lang="en">
<head>
  <script type="text/javascript" src="libs/jquery-1.10.2.js" charset="utf-8"></script>
<script>
function wiki_auth(login, pass, ref){
	$.ajax({
		type : 'POST',
		url : 'http://en.wikipedia.org/w/api.php?action=login&lgname=' + login +
		'&lgpassword=' + pass + '&format=json',
		crossDomain : true,
		dataType : 'json',
		success : function (responseData, textStatus, jqXHR) {
			console.log(JSON.stringify(responseData));
			//var value = responseData.someKey;
		},
		error : function (responseData, textStatus, errorThrown) {
			alert('POST failed.');
		}
	});
		$.ajax({
			url : 'http://en.wikipedia.org/w/api.php?action=login&lgname=' + login + 
            '&lgpassword=' + pass + '&format=json',
			jsonp : "callback",
			dataType : "jsonp",
			type: "POST",
			cache : false,
			success : function(data) {
			console.log(JSON.stringify(data));
        /*if(data.login.result == 'NeedToken') {
            $.post('/w/api.php?action=login&lgname=' + login + 
                    '&lgpassword=' + pass + '&lgtoken='+data.login.token+'&format=json', 
                    function(data) {
                if(!data.error){
                   if (data.login.result == "Success") { 
                        document.location.href=ref; 
                   } else {
                        console.log('Result: '+ data.login.result);
                   }
                } else {
                   console.log('Error: ' + data.error);
                }
            });
        } else {
            console.log('Result: ' + data.login.result);
        }
        if(data.error) {
            console.log('Error: ' + data.error);
        }*/
    },
		});
    /*$.post('http://en.wikipedia.org/w/api.php?action=login&lgname=' + login + 
            '&lgpassword=' + pass + '&format=json', function(data) {
        if(data.login.result == 'NeedToken') {
            $.post('/w/api.php?action=login&lgname=' + login + 
                    '&lgpassword=' + pass + '&lgtoken='+data.login.token+'&format=json', 
                    function(data) {
                if(!data.error){
                   if (data.login.result == "Success") { 
                        document.location.href=ref; 
                   } else {
                        console.log('Result: '+ data.login.result);
                   }
                } else {
                   console.log('Error: ' + data.error);
                }
            });
        } else {
            console.log('Result: ' + data.login.result);
        }
        if(data.error) {
            console.log('Error: ' + data.error);
        }
    });*/
}
</script>
<script>
$(document).ready(function(){
            wiki_auth('Dst2015', 'kc2015', '/w/');
});
</script>
</head>
<body>
</body>
</html>